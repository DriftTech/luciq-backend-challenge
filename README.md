# Luciq Backend Challenge

This project implements a scalable **Chat System** using **Ruby on Rails**, **MySQL**, **Sidekiq**, **Redis**, and **Elasticsearch**.

---

## ðŸ§¾ Overview

Each **Application** has:

- a unique **token** (generated by the system randomly)
- a **name** (provided by the client)

Each Application can have multiple **Chats**.  
Each Chat has:
- a unique **number** (generated by the system sequentially, starting from 1 for each Application)

Each Chat can have multiple **Messages**.  
Each Message has:
- a **body** (content of the message provided by the client)
- a **number** (generated by the system sequentially, starting from 1 for each Chat)

### Clients:
- Never see database IDs of any resource (Application, Chat, Message)
- Identify resources by their unique tokens or numbers.

All endpoints are **RESTful** and fully **containerized** for easy startup.

---

## ðŸ§± Architecture

### Core Components
- **Rails API:** Handles endpoints for applications, chats, and messages.
- **Sidekiq Jobs:** Process message creation asynchronously to ensure scalability.
- **Redis:** Used for Sidekiq job management and caching.
- **MySQL:** Primary relational database for persistent storage.
- **Elasticsearch:** Used for indexing and full-text searching of messages.

---

## ðŸš€ How to Run the Project

### 1. Prerequisites
Make sure you have:
- [Docker](https://www.docker.com/get-started) and [Docker Compose](https://docs.docker.com/compose/install/) installed
- Ports `3000`, `3306`, `6379`, and `9200` available on your machine

### 2. Clone the Repository
```bash
git clone https://github.com/drifttech/luciq-backend-challenge.git
cd luciq-backend-challenge
```

### 3. Build and Start Services

Execute Docker Compose where the docker-compose.yml file is located:

```bash
docker compose up --build
```

This will start the following services:
- MySQL Database
- Redis cache
- Elasticsearch
- Rails server (running on port `3000`)
- Sidekiq Jobs

### 4. Access the Application

- The Rails API would be available at: http://localhost:3000
- Use the included Postman collection (found in the repository) to explore and test API endpoints.

## ðŸ§© API Overview
| Resource    | Endpoint                                                                 | Description                    |
|-------------|--------------------------------------------------------------------------|--------------------------------|
| Application | `POST /applications`                                                     | Create a new application       |
|             | `GET /applications`                                                      | List all applications          |
|             | `GET /applications/:token`                                               | Get application information    |
|             | `PATCH /applications/:token`                                             | Update application information |
| Chats       | `POST /applications/:token/chats`                                        | Create a new chat              |
|             | `GET /applications/:token/chats`                                         | List all chats                 |
|             | `GET /applications/:token/chats/:number`                                 | Get chat information           |
| Messages    | `POST /applications/:token/chats/:chat_number/messages`                  | Create a new message           |
|             | `GET /applications/:token/chats/:chat_number/messages`                   | List all messages              |
|             | `GET /applications/:token/chats/:chat_number/messages/:message_number`   | Get message information        |
|             | `PATCH /applications/:token/chats/:chat_number/messages/:message_number` | Update message information     |
|             | `GET /applications/:token/chats/:chat_number/messages/search?q=QUERY`    | Search for message in chat     |

All reponses exclude database IDs - clients only interact through tokens and numbers


## ðŸ§  Future Improvements

- Add ratelimiting and throttling
- Add pagination
- add API authentication (JWT or Devise/Omniauth)
